---
title: "Investigating Brand Reputation of America's Top 100 Companies"
subtitle: "Proposal"
format: html
editor: visual
---

```{r}
library(dplyr)
library(ggplot2)
library(patchwork)
library(tidyverse)
library(ggrepel)
library(viridis)
library(ggpubr)
library(ggpmisc)
library(ggcorrplot)
```

```{r}
poll <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-05-31/poll.csv') 
reputation <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-05-31/reputation.csv')
```

Correlation matrix:

```{r}
reputation_longer <- reputation |>
  select(company, name, score, industry) |>
  pivot_wider(
    names_from = name,
    values_from = score
  )

reputation_longer <- reputation_longer |>
  rename("Trust" = "TRUST",
         "Ethics" = "ETHICS",
         "Growth" = "GROWTH",
         "Citizenship" = "CITIZENSHIP",
         "Vision" = "VISION",
         "Culture" = "CULTURE")

```

```{r}
attributes_corr <- reputation_longer |>
  as.data.frame() |>               
  select(Trust, Ethics, Growth, `P&S`, Citizenship, Vision, Culture) |>                   
  as.matrix() |>                   
  cor() 
attributes_corr

attributes_p_values <- cor_pmat(attributes_corr)
attributes_p_values
```

```{r}
ggcorrplot(attributes_corr,
           type = "lower",
           method = "circle",
           show.legend = FALSE,
           legend.title = "Correlation Coefficent",
           p.mat = attributes_p_values,
           colors = c("#4ea5e3", "#4ea5e3", "#4ea5e3")) + 
  annotate("text",
           x = 2.7, y = 6, 
           color = "#b320ab", size = 3.8,
           label = "Size of circle indicates 
strength of positive correlation") +
    annotate("text",
           x = 2.7, y = 5, 
           color = "#1aaf82", size = 3.8,
           label = "X's indicate significant 
relationship (alpha = 0.05)") +
  labs(
    title = "Correlation Matrix of Company Attributes",
    subtitle = "Attribute scores from 2022"
  ) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5))
```
