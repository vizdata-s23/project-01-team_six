---
title: "Investigating Brand Reputation of America's Top 100 Companies"
subtitle: "Proposal"
format: html
editor: visual
---

# Dataset

1.  How does company RQ score change between the years of 2017 to 2022 and are the trends consistent with their overall industry?

`poll` dataset. Variables involved include `company`, `rq`, `2022_rq`, and `year`.

-   Remove all companies for which there is an NA value for RQ score for any of these years.

-   Wrangle so `2022_rq` is in the same column as `rq`

-   Filter for the top 3 companies who had the greatest increase in RQ score and top 3 companies with the greatest decrease in RQ score from 2017-2022.

-   Next, we intend on created a progressive line chart to visualize their change over time, where each line represents a company. We will utilize the `gganimate` package with the `transition_reveal()` function set to yearly to demonstrate this, and include the `geom_point()` function grouping each company so for each year

```{r}
knitr::opts_chunk$set(warning = FALSE, echo = FALSE, message = FALSE)
```

```{r load packages}
library(dplyr)
library(ggplot2)
library(patchwork)
library(tidyverse)
library(gganimate)
```

```{r}
poll <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-05-31/poll.csv') 
```

```{r}
poll <- poll |>
  group_by(company) %>%
  filter(!any(is.na(rq) & year %in% 2017:2021)) %>%
  ungroup()
```

```{r}
poll <- select(poll, -'2022_rank',  -'change', -'rank')
```

```{r}
poll_2022 <- poll %>%
  select(company, '2022_rq', 'industry') %>%
  distinct() %>%
  rename(rq = `2022_rq`) %>%
  mutate(year = 2022)
```

```{r}
poll <- bind_rows(poll, poll_2022)
```

```{r}
poll <- select(poll, -'2022_rq')
```

```{r}
poll_change <- poll %>% 
  group_by(company) %>% 
  summarize(rq_change = rq[year == 2022] - rq[year == 2017])

# Get the top 3 companies with the greatest increase and decrease in RQ score
poll_top3_inc <- poll_change %>% 
  arrange(desc(rq_change)) %>% 
  slice(1:3)

poll_top3_dec <- poll_change %>% 
  arrange(rq_change) %>% 
  slice(1:3)
```

```{r}
companies <- poll %>%
  filter(company %in% c("Johnson & Johnson", "Goldman Sachs", "Facebook", "Samsung", "Wells Fargo & Company", "The Walt Disney Company"))
```

```{r}

company_plot <- ggplot(companies, aes(x = year, y = rq, group = company, color = industry)) +
  geom_line(size = 1) +
  geom_point(size = 3) +
  geom_text(aes(label = company), hjust = -0.1, vjust = -0.5, color = "black", size = 2) +
  theme_bw() +
  labs(title = "Top Companies with Largest Increase and Decrease in RQ Score",
       subtitle = "from 2017-2022", 
       x = "Year", 
       y = "RQ Score") + 
  scale_color_manual(values=c(c("#F9C80E", "#EA3546", "#662E9B", "#43BCCD"))) +
  transition_reveal(year) +
  ease_aes('linear') + 
  theme_bw()

animation <- animate(company_plot, fps = 1)
```
