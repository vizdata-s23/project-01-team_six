{
  "hash": "d5051deaea29115cc75528ae6041048b",
  "result": {
    "markdown": "---\ntitle: \"Investigating Brand Reputation of America's Top 100 Companies\"\nsubtitle: \"Proposal\"\nformat: html\neditor: visual\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'dplyr'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n:::\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(patchwork)\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in system(\"timedatectl\", intern = TRUE): running command 'timedatectl'\nhad status 1\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching packages\n───────────────────────────────────────\ntidyverse 1.3.2 ──\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n✔ tibble  3.1.8     ✔ purrr   1.0.1\n✔ tidyr   1.3.0     ✔ stringr 1.5.0\n✔ readr   2.1.3     ✔ forcats 0.5.2\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n```\n:::\n\n```{.r .cell-code}\nlibrary(ggrepel)\nlibrary(viridis)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: viridisLite\n```\n:::\n\n```{.r .cell-code}\nlibrary(ggpubr)\nlibrary(ggpmisc)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: ggpp\n\nAttaching package: 'ggpp'\n\nThe following object is masked from 'package:ggplot2':\n\n    annotate\n```\n:::\n\n```{.r .cell-code}\nlibrary(ggcorrplot)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npoll <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-05-31/poll.csv') \n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 500 Columns: 8\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (2): company, industry\ndbl (6): 2022_rank, 2022_rq, change, year, rank, rq\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\nreputation <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-05-31/reputation.csv')\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 700 Columns: 5\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (3): company, industry, name\ndbl (2): score, rank\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n:::\n\n\n\nCorrelation matrix:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nreputation_longer <- reputation |>\n  select(company, name, score, industry) |>\n  pivot_wider(\n    names_from = name,\n    values_from = score\n  )\n\nreputation_longer <- reputation_longer |>\n  rename(\"Trust\" = \"TRUST\",\n         \"Ethics\" = \"ETHICS\",\n         \"Growth\" = \"GROWTH\",\n         \"Citizenship\" = \"CITIZENSHIP\",\n         \"Vision\" = \"VISION\",\n         \"Culture\" = \"CULTURE\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nattributes_corr <- reputation_longer |>\n  as.data.frame() |>               \n  select(Trust, Ethics, Growth, `P&S`, Citizenship, Vision, Culture) |>                   \n  as.matrix() |>                   \n  cor() \nattributes_corr\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                Trust    Ethics    Growth       P&S Citizenship    Vision\nTrust       1.0000000 0.9641179 0.8249446 0.8513818   0.9578622 0.8500768\nEthics      0.9641179 1.0000000 0.8556506 0.8750432   0.9557266 0.8905120\nGrowth      0.8249446 0.8556506 1.0000000 0.8996737   0.8487326 0.9549344\nP&S         0.8513818 0.8750432 0.8996737 1.0000000   0.8404396 0.9037225\nCitizenship 0.9578622 0.9557266 0.8487326 0.8404396   1.0000000 0.8512050\nVision      0.8500768 0.8905120 0.9549344 0.9037225   0.8512050 1.0000000\nCulture     0.8974707 0.9272064 0.9229968 0.9332273   0.8991918 0.9160946\n              Culture\nTrust       0.8974707\nEthics      0.9272064\nGrowth      0.9229968\nP&S         0.9332273\nCitizenship 0.8991918\nVision      0.9160946\nCulture     1.0000000\n```\n:::\n\n```{.r .cell-code}\nattributes_p_values <- cor_pmat(attributes_corr)\nattributes_p_values\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                  Trust      Ethics      Growth        P&S Citizenship\nTrust       0.000000000 0.002511171 0.003077953 0.09233943 0.003409988\nEthics      0.002511171 0.000000000 0.019233601 0.13660628 0.008996422\nGrowth      0.003077953 0.019233601 0.000000000 0.34158526 0.024309895\nP&S         0.092339433 0.136606280 0.341585258 0.00000000 0.037022036\nCitizenship 0.003409988 0.008996422 0.024309895 0.03702204 0.000000000\nVision      0.022546242 0.097498975 0.009425467 0.39309488 0.029459785\nCulture     0.510942293 0.770770518 0.469346919 0.20816978 0.485956399\n                 Vision   Culture\nTrust       0.022546242 0.5109423\nEthics      0.097498975 0.7707705\nGrowth      0.009425467 0.4693469\nP&S         0.393094885 0.2081698\nCitizenship 0.029459785 0.4859564\nVision      0.000000000 0.6102562\nCulture     0.610256240 0.0000000\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggcorrplot(attributes_corr,\n           type = \"lower\",\n           method = \"circle\",\n           show.legend = TRUE,\n           legend.title = \"Correlation Coefficent\",\n           p.mat = attributes_p_values,\n           colors = c(\"#ce0e5b\", \"white\", \"#4ea5e3\")) + \n  annotate(\"text\",\n           x = 2.7, y = 6, \n           color = \"#b320ab\", size = 3.8,\n           label = \"Size of circle indicates \nstrength of positive correlation\") +\n    annotate(\"text\",\n           x = 2.7, y = 5, \n           color = \"#1aaf82\", size = 3.8,\n           label = \"X's indicate no significant \nrelationship (alpha > 0.05)\") +\n  labs(\n    title = \"Correlation Matrix of Company Attributes\",\n    subtitle = \"Attribute scores from 2022\"\n  ) +\n  theme(plot.title = element_text(hjust = 0.5),\n        plot.subtitle = element_text(hjust = 0.5))\n```\n\n::: {.cell-output-display}\n![](george_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "george_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}